{"data":{"site":{"siteMetadata":{"title":"ğŸ¤”ï¸ Jason Yang's Blog","author":"Jason Yang"}},"markdownRemark":{"id":"b2eb178e-bf94-5f6c-b67d-fab0c133626e","excerpt":"å•ä¾‹æ¨¡å¼å•ä¾‹æ¨¡å¼ï¼ˆSingleton Patternï¼‰æ˜¯ Javaâ€¦","html":"<h1>å•ä¾‹æ¨¡å¼</h1>\n<blockquote>\n<p>å•ä¾‹æ¨¡å¼ï¼ˆSingleton Patternï¼‰æ˜¯ Java ä¸­æœ€ç®€å•çš„è®¾è®¡æ¨¡å¼ä¹‹ä¸€ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºåˆ›å»ºå‹æ¨¡å¼ï¼Œå®ƒæä¾›äº†ä¸€ç§åˆ›å»ºå¯¹è±¡çš„æœ€ä½³æ–¹å¼ã€‚\nè¿™ç§æ¨¡å¼æ¶‰åŠåˆ°ä¸€ä¸ªå•ä¸€çš„ç±»ï¼Œè¯¥ç±»è´Ÿè´£åˆ›å»ºè‡ªå·±çš„å¯¹è±¡ï¼ŒåŒæ—¶ç¡®ä¿åªæœ‰å•ä¸ªå¯¹è±¡è¢«åˆ›å»ºã€‚è¿™ä¸ªç±»æä¾›äº†ä¸€ç§è®¿é—®å…¶å”¯ä¸€çš„å¯¹è±¡çš„æ–¹å¼ï¼Œå¯ä»¥ç›´æ¥è®¿é—®ï¼Œä¸éœ€è¦å®ä¾‹åŒ–è¯¥ç±»çš„å¯¹è±¡ã€‚</p>\n</blockquote>\n<h2>æ³¨æ„ï¼š</h2>\n<ul>\n<li>1ã€å•ä¾‹ç±»åªèƒ½æœ‰ä¸€ä¸ªå®ä¾‹ã€‚</li>\n<li>2ã€å•ä¾‹ç±»å¿…é¡»è‡ªå·±åˆ›å»ºè‡ªå·±çš„å”¯ä¸€å®ä¾‹ã€‚</li>\n<li>3ã€å•ä¾‹ç±»å¿…é¡»ç»™æ‰€æœ‰å…¶ä»–å¯¹è±¡æä¾›è¿™ä¸€å®ä¾‹ã€‚</li>\n</ul>\n<h2>ä»‹ç»</h2>\n<p>æ„å›¾ï¼šä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹ã€‚\nä¸»è¦è§£å†³ï¼šä¸€ä¸ªå…¨å±€ä½¿ç”¨çš„ç±»é¢‘ç¹åœ°åˆ›å»ºä¸é”€æ¯ã€‚\nä½•æ—¶ä½¿ç”¨ï¼šå½“æ‚¨æƒ³æ§åˆ¶å®ä¾‹æ•°ç›®ï¼ŒèŠ‚çœç³»ç»Ÿèµ„æºçš„æ—¶å€™ã€‚\nå¦‚ä½•è§£å†³ï¼šåˆ¤æ–­ç³»ç»Ÿæ˜¯å¦å·²ç»æœ‰è¿™ä¸ªå•ä¾‹ï¼Œå¦‚æœæœ‰åˆ™è¿”å›ï¼Œå¦‚æœæ²¡æœ‰åˆ™åˆ›å»ºã€‚\nå…³é”®ä»£ç ï¼šæ„é€ å‡½æ•°æ˜¯ç§æœ‰çš„ã€‚</p>\n<p>åº”ç”¨å®ä¾‹ï¼š </p>\n<ul>\n<li>1ã€ä¸€ä¸ªå…šåªèƒ½æœ‰ä¸€ä¸ªä¸»å¸­ã€‚ </li>\n<li>2ã€Windows æ˜¯å¤šè¿›ç¨‹å¤šçº¿ç¨‹çš„ï¼Œåœ¨æ“ä½œä¸€ä¸ªæ–‡ä»¶çš„æ—¶å€™ï¼Œå°±ä¸å¯é¿å…åœ°å‡ºç°å¤šä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹åŒæ—¶æ“ä½œä¸€ä¸ªæ–‡ä»¶çš„ç°è±¡ï¼Œæ‰€ä»¥æ‰€æœ‰æ–‡ä»¶çš„å¤„ç†å¿…é¡»é€šè¿‡å”¯ä¸€çš„å®ä¾‹æ¥è¿›è¡Œã€‚ </li>\n<li>3ã€ä¸€äº›è®¾å¤‡ç®¡ç†å™¨å¸¸å¸¸è®¾è®¡ä¸ºå•ä¾‹æ¨¡å¼ï¼Œæ¯”å¦‚ä¸€ä¸ªç”µè„‘æœ‰ä¸¤å°æ‰“å°æœºï¼Œåœ¨è¾“å‡ºçš„æ—¶å€™å°±è¦å¤„ç†ä¸èƒ½ä¸¤å°æ‰“å°æœºæ‰“å°åŒä¸€ä¸ªæ–‡ä»¶ã€‚</li>\n</ul>\n<p>ä¼˜ç‚¹ï¼š </p>\n<ul>\n<li>1ã€åœ¨å†…å­˜é‡Œåªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå‡å°‘äº†å†…å­˜çš„å¼€é”€ï¼Œå°¤å…¶æ˜¯é¢‘ç¹çš„åˆ›å»ºå’Œé”€æ¯å®ä¾‹ï¼ˆæ¯”å¦‚ç®¡ç†å­¦é™¢é¦–é¡µé¡µé¢ç¼“å­˜ï¼‰ã€‚ </li>\n<li>2ã€é¿å…å¯¹èµ„æºçš„å¤šé‡å ç”¨ï¼ˆæ¯”å¦‚å†™æ–‡ä»¶æ“ä½œï¼‰ã€‚</li>\n</ul>\n<p>ç¼ºç‚¹ï¼šæ²¡æœ‰æ¥å£ï¼Œä¸èƒ½ç»§æ‰¿ï¼Œä¸å•ä¸€èŒè´£åŸåˆ™å†²çªï¼Œä¸€ä¸ªç±»åº”è¯¥åªå…³å¿ƒå†…éƒ¨é€»è¾‘ï¼Œè€Œä¸å…³å¿ƒå¤–é¢æ€ä¹ˆæ ·æ¥å®ä¾‹åŒ–ã€‚</p>\n<p>ä½¿ç”¨åœºæ™¯ï¼š </p>\n<ul>\n<li>1ã€è¦æ±‚ç”Ÿäº§å”¯ä¸€åºåˆ—å·ã€‚ </li>\n<li>2ã€WEB ä¸­çš„è®¡æ•°å™¨ï¼Œä¸ç”¨æ¯æ¬¡åˆ·æ–°éƒ½åœ¨æ•°æ®åº“é‡ŒåŠ ä¸€æ¬¡ï¼Œç”¨å•ä¾‹å…ˆç¼“å­˜èµ·æ¥ã€‚ </li>\n<li>3ã€åˆ›å»ºçš„ä¸€ä¸ªå¯¹è±¡éœ€è¦æ¶ˆè€—çš„èµ„æºè¿‡å¤šï¼Œæ¯”å¦‚ I/O ä¸æ•°æ®åº“çš„è¿æ¥ç­‰ã€‚</li>\n</ul>\n<p>æ³¨æ„äº‹é¡¹ï¼šgetInstance() æ–¹æ³•ä¸­éœ€è¦ä½¿ç”¨åŒæ­¥é” synchronized (Singleton.class) é˜²æ­¢å¤šçº¿ç¨‹åŒæ—¶è¿›å…¥é€ æˆ instance è¢«å¤šæ¬¡å®ä¾‹åŒ–ã€‚</p>\n<h2>å®ç°</h2>\n<p>æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª SingleObject ç±»ã€‚SingleObject ç±»æœ‰å®ƒçš„ç§æœ‰æ„é€ å‡½æ•°å’Œæœ¬èº«çš„ä¸€ä¸ªé™æ€å®ä¾‹ã€‚</p>\n<p>SingleObject ç±»æä¾›äº†ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œä¾›å¤–ç•Œè·å–å®ƒçš„é™æ€å®ä¾‹ã€‚</p>\n<p>SingletonPatternDemoï¼Œæˆ‘ä»¬çš„æ¼”ç¤ºç±»ä½¿ç”¨ SingleObject ç±»æ¥è·å– SingleObject å¯¹è±¡ã€‚</p>\n<p><img src=\"https://raw.githubusercontent.com/jasonyang86/nocoder/master/data/images/design-pattern/singleton_pattern_uml_diagram.jpg\"></p>\n<h3>æ­¥éª¤ 1</h3>\n<p>åˆ›å»ºä¸€ä¸ª Singleton ç±»ã€‚\nSingleObject.java</p>\n<div class='midnight'><pre class=\"editor editor-colors\"><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>public</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--class syntax--identifier syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>class</span></span><span>&nbsp;</span><span class=\"syntax--entity syntax--name syntax--type syntax--class syntax--java\"><span>SingleObject</span></span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--class syntax--begin syntax--java\"><span>{</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span>&nbsp;</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--whitespace syntax--comment syntax--leading syntax--java\"><span>&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--comment syntax--line syntax--double-slash syntax--java\"><span class=\"syntax--punctuation syntax--definition syntax--comment syntax--java\"><span>//</span></span><span>åˆ›å»º&nbsp;SingleObject&nbsp;çš„ä¸€ä¸ªå¯¹è±¡</span><span>&nbsp;</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--storage syntax--modifier syntax--java\"><span>private</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--definition syntax--variable syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>static</span></span><span>&nbsp;</span><span class=\"syntax--storage syntax--type syntax--java\"><span>SingleObject</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--definition syntax--variable syntax--name syntax--java\"><span>instance</span></span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--java\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--new syntax--java\"><span>new</span></span><span>&nbsp;</span><span class=\"syntax--storage syntax--type syntax--java\"><span>SingleObject</span></span><span>(</span><span>)</span></span><span class=\"syntax--punctuation syntax--terminator syntax--java\"><span>;</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span>&nbsp;</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--whitespace syntax--comment syntax--leading syntax--java\"><span>&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--comment syntax--line syntax--double-slash syntax--java\"><span class=\"syntax--punctuation syntax--definition syntax--comment syntax--java\"><span>//</span></span><span>è®©æ„é€ å‡½æ•°ä¸º&nbsp;privateï¼Œè¿™æ ·è¯¥ç±»å°±ä¸ä¼šè¢«å®ä¾‹åŒ–</span><span>&nbsp;</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>private</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--method syntax--identifier syntax--java\"><span class=\"syntax--entity syntax--name syntax--function syntax--java\"><span>SingleObject</span></span><span>(</span><span>)</span></span><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--method syntax--begin syntax--java\"><span>{</span></span></span><span class=\"syntax--punctuation syntax--section syntax--method syntax--end syntax--java\"><span>}</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span>&nbsp;</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--whitespace syntax--comment syntax--leading syntax--java\"><span>&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--comment syntax--line syntax--double-slash syntax--java\"><span class=\"syntax--punctuation syntax--definition syntax--comment syntax--java\"><span>//</span></span><span>è·å–å”¯ä¸€å¯ç”¨çš„å¯¹è±¡</span><span>&nbsp;</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>public</span></span><span>&nbsp;</span><span class=\"syntax--storage syntax--modifier syntax--java\"><span>static</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--method syntax--return-type syntax--java\"><span class=\"syntax--storage syntax--type syntax--java\"><span>SingleObject</span></span><span>&nbsp;</span></span><span class=\"syntax--meta syntax--method syntax--identifier syntax--java\"><span class=\"syntax--entity syntax--name syntax--function syntax--java\"><span>getInstance</span></span><span>(</span><span>)</span></span><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--method syntax--begin syntax--java\"><span>{</span></span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--java\"><span>return</span></span><span>&nbsp;instance</span><span class=\"syntax--punctuation syntax--terminator syntax--java\"><span>;</span></span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--punctuation syntax--section syntax--method syntax--end syntax--java\"><span>}</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span>&nbsp;</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>public</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--method syntax--return-type syntax--java\"><span class=\"syntax--storage syntax--type syntax--primitive syntax--array syntax--java\"><span>void</span></span><span>&nbsp;</span></span><span class=\"syntax--meta syntax--method syntax--identifier syntax--java\"><span class=\"syntax--entity syntax--name syntax--function syntax--java\"><span>showMessage</span></span><span>(</span><span>)</span></span><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--method syntax--begin syntax--java\"><span>{</span></span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--storage syntax--type syntax--java\"><span>System</span></span><span class=\"syntax--keyword syntax--operator syntax--dereference syntax--java\"><span>.</span></span><span>out</span><span class=\"syntax--keyword syntax--operator syntax--dereference syntax--java\"><span>.</span></span><span class=\"syntax--meta syntax--method-call syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span>println</span></span><span class=\"syntax--punctuation syntax--definition syntax--method-parameters syntax--begin syntax--java\"><span>(</span></span><span class=\"syntax--string syntax--quoted syntax--double syntax--java\"><span class=\"syntax--punctuation syntax--definition syntax--string syntax--begin syntax--java\"><span>&quot;</span></span><span>Hello&nbsp;World!</span><span class=\"syntax--punctuation syntax--definition syntax--string syntax--end syntax--java\"><span>&quot;</span></span></span><span class=\"syntax--punctuation syntax--definition syntax--method-parameters syntax--end syntax--java\"><span>)</span></span></span><span class=\"syntax--punctuation syntax--terminator syntax--java\"><span>;</span></span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--punctuation syntax--section syntax--method syntax--end syntax--java\"><span>}</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--class syntax--end syntax--java\"><span>}</span></span></span></span></div></pre></div>\n<h3>æ­¥éª¤ 2</h3>\n<p>ä» singleton ç±»è·å–å”¯ä¸€çš„å¯¹è±¡ã€‚\nSingletonPatternDemo.java</p>\n<div class='midnight'><pre class=\"editor editor-colors\"><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>public</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--class syntax--identifier syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>class</span></span><span>&nbsp;</span><span class=\"syntax--entity syntax--name syntax--type syntax--class syntax--java\"><span>SingletonPatternDemo</span></span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--class syntax--begin syntax--java\"><span>{</span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>public</span></span><span>&nbsp;</span><span class=\"syntax--storage syntax--modifier syntax--java\"><span>static</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--method syntax--return-type syntax--java\"><span class=\"syntax--storage syntax--type syntax--primitive syntax--array syntax--java\"><span>void</span></span><span>&nbsp;</span></span><span class=\"syntax--meta syntax--method syntax--identifier syntax--java\"><span class=\"syntax--entity syntax--name syntax--function syntax--java\"><span>main</span></span><span>(</span><span class=\"syntax--storage syntax--type syntax--object syntax--array syntax--java\"><span>String</span></span><span>[]&nbsp;</span><span class=\"syntax--variable syntax--parameter syntax--java\"><span>args</span></span><span>)</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--method syntax--begin syntax--java\"><span>{</span></span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--whitespace syntax--comment syntax--leading syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--comment syntax--line syntax--double-slash syntax--java\"><span class=\"syntax--punctuation syntax--definition syntax--comment syntax--java\"><span>//</span></span><span>ä¸åˆæ³•çš„æ„é€ å‡½æ•°</span><span>&nbsp;</span></span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--whitespace syntax--comment syntax--leading syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--comment syntax--line syntax--double-slash syntax--java\"><span class=\"syntax--punctuation syntax--definition syntax--comment syntax--java\"><span>//</span></span><span>ç¼–è¯‘æ—¶é”™è¯¯ï¼šæ„é€ å‡½æ•°&nbsp;SingleObject()&nbsp;æ˜¯ä¸å¯è§çš„</span><span>&nbsp;</span></span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--whitespace syntax--comment syntax--leading syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--comment syntax--line syntax--double-slash syntax--java\"><span class=\"syntax--punctuation syntax--definition syntax--comment syntax--java\"><span>//</span></span><span>SingleObject&nbsp;object&nbsp;=&nbsp;new&nbsp;SingleObject();</span><span>&nbsp;</span></span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--whitespace syntax--comment syntax--leading syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--comment syntax--line syntax--double-slash syntax--java\"><span class=\"syntax--punctuation syntax--definition syntax--comment syntax--java\"><span>//</span></span><span>è·å–å”¯ä¸€å¯ç”¨çš„å¯¹è±¡</span><span>&nbsp;</span></span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--storage syntax--type syntax--java\"><span>SingleObject</span></span><span>&nbsp;object&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--java\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--storage syntax--type syntax--java\"><span>SingleObject</span></span><span class=\"syntax--keyword syntax--operator syntax--dereference syntax--java\"><span>.</span></span><span class=\"syntax--meta syntax--method-call syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span>getInstance</span></span><span class=\"syntax--punctuation syntax--definition syntax--method-parameters syntax--begin syntax--java\"><span>(</span></span><span class=\"syntax--punctuation syntax--definition syntax--method-parameters syntax--end syntax--java\"><span>)</span></span></span><span class=\"syntax--punctuation syntax--terminator syntax--java\"><span>;</span></span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--whitespace syntax--comment syntax--leading syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--comment syntax--line syntax--double-slash syntax--java\"><span class=\"syntax--punctuation syntax--definition syntax--comment syntax--java\"><span>//</span></span><span>æ˜¾ç¤ºæ¶ˆæ¯</span><span>&nbsp;</span></span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object</span><span class=\"syntax--keyword syntax--operator syntax--dereference syntax--java\"><span>.</span></span><span class=\"syntax--meta syntax--method-call syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span>showMessage</span></span><span class=\"syntax--punctuation syntax--definition syntax--method-parameters syntax--begin syntax--java\"><span>(</span></span><span class=\"syntax--punctuation syntax--definition syntax--method-parameters syntax--end syntax--java\"><span>)</span></span></span><span class=\"syntax--punctuation syntax--terminator syntax--java\"><span>;</span></span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--punctuation syntax--section syntax--method syntax--end syntax--java\"><span>}</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--class syntax--end syntax--java\"><span>}</span></span></span></span></div></pre></div>\n<h3>æ­¥éª¤ 3</h3>\n<p>éªŒè¯è¾“å‡ºã€‚</p>\n<div class='midnight'><pre class=\"editor editor-colors\"><div class=\"line\"><span class=\"syntax--text syntax--plain syntax--null-grammar\"><span>Hello&nbsp;World!</span></span></div></pre></div>\n<p>å•ä¾‹æ¨¡å¼çš„å‡ ç§å®ç°æ–¹å¼\nå•ä¾‹æ¨¡å¼çš„å®ç°æœ‰å¤šç§æ–¹å¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>\n<h3>1ã€æ‡’æ±‰å¼ï¼Œçº¿ç¨‹ä¸å®‰å…¨</h3>\n<p>æ˜¯å¦ Lazy åˆå§‹åŒ–ï¼šæ˜¯\næ˜¯å¦å¤šçº¿ç¨‹å®‰å…¨ï¼šå¦\nå®ç°éš¾åº¦ï¼šæ˜“\næè¿°ï¼šè¿™ç§æ–¹å¼æ˜¯æœ€åŸºæœ¬çš„å®ç°æ–¹å¼ï¼Œè¿™ç§å®ç°æœ€å¤§çš„é—®é¢˜å°±æ˜¯ä¸æ”¯æŒå¤šçº¿ç¨‹ã€‚å› ä¸ºæ²¡æœ‰åŠ é” synchronizedï¼Œæ‰€ä»¥ä¸¥æ ¼æ„ä¹‰ä¸Šå®ƒå¹¶ä¸ç®—å•ä¾‹æ¨¡å¼ã€‚\nè¿™ç§æ–¹å¼ lazy loading å¾ˆæ˜æ˜¾ï¼Œä¸è¦æ±‚çº¿ç¨‹å®‰å…¨ï¼Œåœ¨å¤šçº¿ç¨‹ä¸èƒ½æ­£å¸¸å·¥ä½œã€‚\nä»£ç å®ä¾‹ï¼š</p>\n<div class='midnight'><pre class=\"editor editor-colors\"><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>public</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--class syntax--identifier syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>class</span></span><span>&nbsp;</span><span class=\"syntax--entity syntax--name syntax--type syntax--class syntax--java\"><span>Singleton</span></span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--class syntax--begin syntax--java\"><span>{</span></span><span>&nbsp;&nbsp;</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--storage syntax--modifier syntax--java\"><span>private</span></span><span>&nbsp;</span><span class=\"syntax--storage syntax--modifier syntax--java\"><span>static</span></span><span>&nbsp;</span><span class=\"syntax--storage syntax--type syntax--java\"><span>Singleton</span></span><span>&nbsp;instance</span><span class=\"syntax--punctuation syntax--terminator syntax--java\"><span>;</span></span><span>&nbsp;&nbsp;</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>private</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--method syntax--identifier syntax--java\"><span class=\"syntax--entity syntax--name syntax--function syntax--java\"><span>Singleton</span></span><span>&nbsp;(</span><span>)</span></span><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--method syntax--begin syntax--java\"><span>{</span></span></span><span class=\"syntax--punctuation syntax--section syntax--method syntax--end syntax--java\"><span>}</span></span></span><span>&nbsp;&nbsp;</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span>&nbsp;&nbsp;</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>public</span></span><span>&nbsp;</span><span class=\"syntax--storage syntax--modifier syntax--java\"><span>static</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--method syntax--return-type syntax--java\"><span class=\"syntax--storage syntax--type syntax--java\"><span>Singleton</span></span><span>&nbsp;</span></span><span class=\"syntax--meta syntax--method syntax--identifier syntax--java\"><span class=\"syntax--entity syntax--name syntax--function syntax--java\"><span>getInstance</span></span><span>(</span><span>)</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--method syntax--begin syntax--java\"><span>{</span></span><span>&nbsp;&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--java\"><span>if</span></span><span>&nbsp;</span><span>(</span><span>instance&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--comparison syntax--java\"><span>==</span></span><span>&nbsp;</span><span class=\"syntax--constant syntax--language syntax--java\"><span>null</span></span><span>)</span><span>&nbsp;</span><span class=\"syntax--punctuation syntax--section syntax--block syntax--begin syntax--java\"><span>{</span></span><span>&nbsp;&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instance&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--java\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--new syntax--java\"><span>new</span></span><span>&nbsp;</span><span class=\"syntax--storage syntax--type syntax--java\"><span>Singleton</span></span><span>(</span><span>)</span><span class=\"syntax--punctuation syntax--terminator syntax--java\"><span>;</span></span><span>&nbsp;&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--punctuation syntax--section syntax--block syntax--end syntax--java\"><span>}</span></span><span>&nbsp;&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--java\"><span>return</span></span><span>&nbsp;instance</span><span class=\"syntax--punctuation syntax--terminator syntax--java\"><span>;</span></span><span>&nbsp;&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--punctuation syntax--section syntax--method syntax--end syntax--java\"><span>}</span></span></span><span>&nbsp;&nbsp;</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--class syntax--end syntax--java\"><span>}</span></span></span><span>&nbsp;&nbsp;</span></span></div></pre></div>\n<p>æ¥ä¸‹æ¥ä»‹ç»çš„å‡ ç§å®ç°æ–¹å¼éƒ½æ”¯æŒå¤šçº¿ç¨‹ï¼Œä½†æ˜¯åœ¨æ€§èƒ½ä¸Šæœ‰æ‰€å·®å¼‚ã€‚</p>\n<h3>2ã€æ‡’æ±‰å¼ï¼Œçº¿ç¨‹å®‰å…¨</h3>\n<p>æ˜¯å¦ Lazy åˆå§‹åŒ–ï¼šæ˜¯\næ˜¯å¦å¤šçº¿ç¨‹å®‰å…¨ï¼šæ˜¯\nå®ç°éš¾åº¦ï¼šæ˜“\næè¿°ï¼šè¿™ç§æ–¹å¼å…·å¤‡å¾ˆå¥½çš„ lazy loadingï¼Œèƒ½å¤Ÿåœ¨å¤šçº¿ç¨‹ä¸­å¾ˆå¥½çš„å·¥ä½œï¼Œä½†æ˜¯ï¼Œæ•ˆç‡å¾ˆä½ï¼Œ99% æƒ…å†µä¸‹ä¸éœ€è¦åŒæ­¥ã€‚\nä¼˜ç‚¹ï¼šç¬¬ä¸€æ¬¡è°ƒç”¨æ‰åˆå§‹åŒ–ï¼Œé¿å…å†…å­˜æµªè´¹ã€‚\nç¼ºç‚¹ï¼šå¿…é¡»åŠ é” synchronized æ‰èƒ½ä¿è¯å•ä¾‹ï¼Œä½†åŠ é”ä¼šå½±å“æ•ˆç‡ã€‚\ngetInstance() çš„æ€§èƒ½å¯¹åº”ç”¨ç¨‹åºä¸æ˜¯å¾ˆå…³é”®ï¼ˆè¯¥æ–¹æ³•ä½¿ç”¨ä¸å¤ªé¢‘ç¹ï¼‰ã€‚\nä»£ç å®ä¾‹ï¼š</p>\n<div class='midnight'><pre class=\"editor editor-colors\"><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>public</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--class syntax--identifier syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>class</span></span><span>&nbsp;</span><span class=\"syntax--entity syntax--name syntax--type syntax--class syntax--java\"><span>Singleton</span></span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--class syntax--begin syntax--java\"><span>{</span></span><span>&nbsp;&nbsp;</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--storage syntax--modifier syntax--java\"><span>private</span></span><span>&nbsp;</span><span class=\"syntax--storage syntax--modifier syntax--java\"><span>static</span></span><span>&nbsp;</span><span class=\"syntax--storage syntax--type syntax--java\"><span>Singleton</span></span><span>&nbsp;instance</span><span class=\"syntax--punctuation syntax--terminator syntax--java\"><span>;</span></span><span>&nbsp;&nbsp;</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>private</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--method syntax--identifier syntax--java\"><span class=\"syntax--entity syntax--name syntax--function syntax--java\"><span>Singleton</span></span><span>&nbsp;(</span><span>)</span></span><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--method syntax--begin syntax--java\"><span>{</span></span></span><span class=\"syntax--punctuation syntax--section syntax--method syntax--end syntax--java\"><span>}</span></span></span><span>&nbsp;&nbsp;</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>public</span></span><span>&nbsp;</span><span class=\"syntax--storage syntax--modifier syntax--java\"><span>static</span></span><span>&nbsp;</span><span class=\"syntax--storage syntax--modifier syntax--java\"><span>synchronized</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--method syntax--return-type syntax--java\"><span class=\"syntax--storage syntax--type syntax--java\"><span>Singleton</span></span><span>&nbsp;</span></span><span class=\"syntax--meta syntax--method syntax--identifier syntax--java\"><span class=\"syntax--entity syntax--name syntax--function syntax--java\"><span>getInstance</span></span><span>(</span><span>)</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--method syntax--begin syntax--java\"><span>{</span></span><span>&nbsp;&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--java\"><span>if</span></span><span>&nbsp;</span><span>(</span><span>instance&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--comparison syntax--java\"><span>==</span></span><span>&nbsp;</span><span class=\"syntax--constant syntax--language syntax--java\"><span>null</span></span><span>)</span><span>&nbsp;</span><span class=\"syntax--punctuation syntax--section syntax--block syntax--begin syntax--java\"><span>{</span></span><span>&nbsp;&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instance&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--java\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--new syntax--java\"><span>new</span></span><span>&nbsp;</span><span class=\"syntax--storage syntax--type syntax--java\"><span>Singleton</span></span><span>(</span><span>)</span><span class=\"syntax--punctuation syntax--terminator syntax--java\"><span>;</span></span><span>&nbsp;&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--punctuation syntax--section syntax--block syntax--end syntax--java\"><span>}</span></span><span>&nbsp;&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--java\"><span>return</span></span><span>&nbsp;instance</span><span class=\"syntax--punctuation syntax--terminator syntax--java\"><span>;</span></span><span>&nbsp;&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--punctuation syntax--section syntax--method syntax--end syntax--java\"><span>}</span></span></span><span>&nbsp;&nbsp;</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--class syntax--end syntax--java\"><span>}</span></span></span><span>&nbsp;</span></span></div></pre></div>\n<h3>3ã€é¥¿æ±‰å¼</h3>\n<p>æ˜¯å¦ Lazy åˆå§‹åŒ–ï¼šå¦\næ˜¯å¦å¤šçº¿ç¨‹å®‰å…¨ï¼šæ˜¯\nå®ç°éš¾åº¦ï¼šæ˜“\næè¿°ï¼šè¿™ç§æ–¹å¼æ¯”è¾ƒå¸¸ç”¨ï¼Œä½†å®¹æ˜“äº§ç”Ÿåƒåœ¾å¯¹è±¡ã€‚\nä¼˜ç‚¹ï¼šæ²¡æœ‰åŠ é”ï¼Œæ‰§è¡Œæ•ˆç‡ä¼šæé«˜ã€‚\nç¼ºç‚¹ï¼šç±»åŠ è½½æ—¶å°±åˆå§‹åŒ–ï¼Œæµªè´¹å†…å­˜ã€‚\nå®ƒåŸºäº classloder æœºåˆ¶é¿å…äº†å¤šçº¿ç¨‹çš„åŒæ­¥é—®é¢˜ï¼Œä¸è¿‡ï¼Œinstance åœ¨ç±»è£…è½½æ—¶å°±å®ä¾‹åŒ–ï¼Œè™½ç„¶å¯¼è‡´ç±»è£…è½½çš„åŸå› æœ‰å¾ˆå¤šç§ï¼Œåœ¨å•ä¾‹æ¨¡å¼ä¸­å¤§å¤šæ•°éƒ½æ˜¯è°ƒç”¨ getInstance æ–¹æ³•ï¼Œ ä½†æ˜¯ä¹Ÿä¸èƒ½ç¡®å®šæœ‰å…¶ä»–çš„æ–¹å¼ï¼ˆæˆ–è€…å…¶ä»–çš„é™æ€æ–¹æ³•ï¼‰å¯¼è‡´ç±»è£…è½½ï¼Œè¿™æ—¶å€™åˆå§‹åŒ– instance æ˜¾ç„¶æ²¡æœ‰è¾¾åˆ° lazy loading çš„æ•ˆæœã€‚\nä»£ç å®ä¾‹ï¼š</p>\n<div class='midnight'><pre class=\"editor editor-colors\"><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>public</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--class syntax--identifier syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>class</span></span><span>&nbsp;</span><span class=\"syntax--entity syntax--name syntax--type syntax--class syntax--java\"><span>Singleton</span></span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--class syntax--begin syntax--java\"><span>{</span></span><span>&nbsp;&nbsp;</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--storage syntax--modifier syntax--java\"><span>private</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--definition syntax--variable syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>static</span></span><span>&nbsp;</span><span class=\"syntax--storage syntax--type syntax--java\"><span>Singleton</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--definition syntax--variable syntax--name syntax--java\"><span>instance</span></span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--java\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--new syntax--java\"><span>new</span></span><span>&nbsp;</span><span class=\"syntax--storage syntax--type syntax--java\"><span>Singleton</span></span><span>(</span><span>)</span></span><span class=\"syntax--punctuation syntax--terminator syntax--java\"><span>;</span></span><span>&nbsp;&nbsp;</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>private</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--method syntax--identifier syntax--java\"><span class=\"syntax--entity syntax--name syntax--function syntax--java\"><span>Singleton</span></span><span>&nbsp;(</span><span>)</span></span><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--method syntax--begin syntax--java\"><span>{</span></span></span><span class=\"syntax--punctuation syntax--section syntax--method syntax--end syntax--java\"><span>}</span></span></span><span>&nbsp;&nbsp;</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>public</span></span><span>&nbsp;</span><span class=\"syntax--storage syntax--modifier syntax--java\"><span>static</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--method syntax--return-type syntax--java\"><span class=\"syntax--storage syntax--type syntax--java\"><span>Singleton</span></span><span>&nbsp;</span></span><span class=\"syntax--meta syntax--method syntax--identifier syntax--java\"><span class=\"syntax--entity syntax--name syntax--function syntax--java\"><span>getInstance</span></span><span>(</span><span>)</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--method syntax--begin syntax--java\"><span>{</span></span><span>&nbsp;&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--java\"><span>return</span></span><span>&nbsp;instance</span><span class=\"syntax--punctuation syntax--terminator syntax--java\"><span>;</span></span><span>&nbsp;&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--punctuation syntax--section syntax--method syntax--end syntax--java\"><span>}</span></span></span><span>&nbsp;&nbsp;</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--class syntax--end syntax--java\"><span>}</span></span></span><span>&nbsp;&nbsp;</span></span></div></pre></div>\n<h3>4ã€åŒæ£€é”/åŒé‡æ ¡éªŒé”ï¼ˆDCLï¼Œå³ double-checked lockingï¼‰</h3>\n<p>JDK ç‰ˆæœ¬ï¼šJDK1.5 èµ·\næ˜¯å¦ Lazy åˆå§‹åŒ–ï¼šæ˜¯\næ˜¯å¦å¤šçº¿ç¨‹å®‰å…¨ï¼šæ˜¯\nå®ç°éš¾åº¦ï¼šè¾ƒå¤æ‚\næè¿°ï¼šè¿™ç§æ–¹å¼é‡‡ç”¨åŒé”æœºåˆ¶ï¼Œå®‰å…¨ä¸”åœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹èƒ½ä¿æŒé«˜æ€§èƒ½ã€‚\ngetInstance() çš„æ€§èƒ½å¯¹åº”ç”¨ç¨‹åºå¾ˆå…³é”®ã€‚\nä»£ç å®ä¾‹ï¼š</p>\n<div class='midnight'><pre class=\"editor editor-colors\"><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>public</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--class syntax--identifier syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>class</span></span><span>&nbsp;</span><span class=\"syntax--entity syntax--name syntax--type syntax--class syntax--java\"><span>Singleton</span></span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--class syntax--begin syntax--java\"><span>{</span></span><span>&nbsp;&nbsp;</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--storage syntax--modifier syntax--java\"><span>private</span></span><span>&nbsp;volatile&nbsp;</span><span class=\"syntax--storage syntax--modifier syntax--java\"><span>static</span></span><span>&nbsp;</span><span class=\"syntax--storage syntax--type syntax--java\"><span>Singleton</span></span><span>&nbsp;singleton</span><span class=\"syntax--punctuation syntax--terminator syntax--java\"><span>;</span></span><span>&nbsp;&nbsp;</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>private</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--method syntax--identifier syntax--java\"><span class=\"syntax--entity syntax--name syntax--function syntax--java\"><span>Singleton</span></span><span>&nbsp;(</span><span>)</span></span><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--method syntax--begin syntax--java\"><span>{</span></span></span><span class=\"syntax--punctuation syntax--section syntax--method syntax--end syntax--java\"><span>}</span></span></span><span>&nbsp;&nbsp;</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>public</span></span><span>&nbsp;</span><span class=\"syntax--storage syntax--modifier syntax--java\"><span>static</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--method syntax--return-type syntax--java\"><span class=\"syntax--storage syntax--type syntax--java\"><span>Singleton</span></span><span>&nbsp;</span></span><span class=\"syntax--meta syntax--method syntax--identifier syntax--java\"><span class=\"syntax--entity syntax--name syntax--function syntax--java\"><span>getSingleton</span></span><span>(</span><span>)</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--method syntax--begin syntax--java\"><span>{</span></span><span>&nbsp;&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--java\"><span>if</span></span><span>&nbsp;</span><span>(</span><span>singleton&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--comparison syntax--java\"><span>==</span></span><span>&nbsp;</span><span class=\"syntax--constant syntax--language syntax--java\"><span>null</span></span><span>)</span><span>&nbsp;</span><span class=\"syntax--punctuation syntax--section syntax--block syntax--begin syntax--java\"><span>{</span></span><span>&nbsp;&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--storage syntax--modifier syntax--java\"><span>synchronized</span></span><span>&nbsp;</span><span>(</span><span class=\"syntax--storage syntax--type syntax--java\"><span>Singleton</span></span><span class=\"syntax--keyword syntax--operator syntax--dereference syntax--java\"><span>.</span></span><span>class</span><span>)</span><span>&nbsp;</span><span class=\"syntax--punctuation syntax--section syntax--block syntax--begin syntax--java\"><span>{</span></span><span>&nbsp;&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--java\"><span>if</span></span><span>&nbsp;</span><span>(</span><span>singleton&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--comparison syntax--java\"><span>==</span></span><span>&nbsp;</span><span class=\"syntax--constant syntax--language syntax--java\"><span>null</span></span><span>)</span><span>&nbsp;</span><span class=\"syntax--punctuation syntax--section syntax--block syntax--begin syntax--java\"><span>{</span></span><span>&nbsp;&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singleton&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--java\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--new syntax--java\"><span>new</span></span><span>&nbsp;</span><span class=\"syntax--storage syntax--type syntax--java\"><span>Singleton</span></span><span>(</span><span>)</span><span class=\"syntax--punctuation syntax--terminator syntax--java\"><span>;</span></span><span>&nbsp;&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--punctuation syntax--section syntax--block syntax--end syntax--java\"><span>}</span></span><span>&nbsp;&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--punctuation syntax--section syntax--block syntax--end syntax--java\"><span>}</span></span><span>&nbsp;&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--punctuation syntax--section syntax--block syntax--end syntax--java\"><span>}</span></span><span>&nbsp;&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--java\"><span>return</span></span><span>&nbsp;singleton</span><span class=\"syntax--punctuation syntax--terminator syntax--java\"><span>;</span></span><span>&nbsp;&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--punctuation syntax--section syntax--method syntax--end syntax--java\"><span>}</span></span></span><span>&nbsp;&nbsp;</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--class syntax--end syntax--java\"><span>}</span></span></span><span>&nbsp;&nbsp;</span></span></div></pre></div>\n<h3>5ã€ç™»è®°å¼/é™æ€å†…éƒ¨ç±»</h3>\n<p>æ˜¯å¦ Lazy åˆå§‹åŒ–ï¼šæ˜¯\næ˜¯å¦å¤šçº¿ç¨‹å®‰å…¨ï¼šæ˜¯\nå®ç°éš¾åº¦ï¼šä¸€èˆ¬\næè¿°ï¼šè¿™ç§æ–¹å¼èƒ½è¾¾åˆ°åŒæ£€é”æ–¹å¼ä¸€æ ·çš„åŠŸæ•ˆï¼Œä½†å®ç°æ›´ç®€å•ã€‚å¯¹é™æ€åŸŸä½¿ç”¨å»¶è¿Ÿåˆå§‹åŒ–ï¼Œåº”ä½¿ç”¨è¿™ç§æ–¹å¼è€Œä¸æ˜¯åŒæ£€é”æ–¹å¼ã€‚è¿™ç§æ–¹å¼åªé€‚ç”¨äºé™æ€åŸŸçš„æƒ…å†µï¼ŒåŒæ£€é”æ–¹å¼å¯åœ¨å®ä¾‹åŸŸéœ€è¦å»¶è¿Ÿåˆå§‹åŒ–æ—¶ä½¿ç”¨ã€‚\nè¿™ç§æ–¹å¼åŒæ ·åˆ©ç”¨äº† classloder æœºåˆ¶æ¥ä¿è¯åˆå§‹åŒ– instance æ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œå®ƒè·Ÿç¬¬ 3 ç§æ–¹å¼ä¸åŒçš„æ˜¯ï¼šç¬¬ 3 ç§æ–¹å¼åªè¦ Singleton ç±»è¢«è£…è½½äº†ï¼Œé‚£ä¹ˆ instance å°±ä¼šè¢«å®ä¾‹åŒ–ï¼ˆæ²¡æœ‰è¾¾åˆ° lazy loading æ•ˆæœï¼‰ï¼Œè€Œè¿™ç§æ–¹å¼æ˜¯ Singleton ç±»è¢«è£…è½½äº†ï¼Œinstance ä¸ä¸€å®šè¢«åˆå§‹åŒ–ã€‚å› ä¸º SingletonHolder ç±»æ²¡æœ‰è¢«ä¸»åŠ¨ä½¿ç”¨ï¼Œåªæœ‰æ˜¾ç¤ºé€šè¿‡è°ƒç”¨ getInstance æ–¹æ³•æ—¶ï¼Œæ‰ä¼šæ˜¾ç¤ºè£…è½½ SingletonHolder ç±»ï¼Œä»è€Œå®ä¾‹åŒ– instanceã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœå®ä¾‹åŒ– instance å¾ˆæ¶ˆè€—èµ„æºï¼Œæ‰€ä»¥æƒ³è®©å®ƒå»¶è¿ŸåŠ è½½ï¼Œå¦å¤–ä¸€æ–¹é¢ï¼Œåˆä¸å¸Œæœ›åœ¨ Singleton ç±»åŠ è½½æ—¶å°±å®ä¾‹åŒ–ï¼Œå› ä¸ºä¸èƒ½ç¡®ä¿ Singleton ç±»è¿˜å¯èƒ½åœ¨å…¶ä»–çš„åœ°æ–¹è¢«ä¸»åŠ¨ä½¿ç”¨ä»è€Œè¢«åŠ è½½ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å®ä¾‹åŒ– instance æ˜¾ç„¶æ˜¯ä¸åˆé€‚çš„ã€‚è¿™ä¸ªæ—¶å€™ï¼Œè¿™ç§æ–¹å¼ç›¸æ¯”ç¬¬ 3 ç§æ–¹å¼å°±æ˜¾å¾—å¾ˆåˆç†ã€‚\nä»£ç å®ä¾‹ï¼š</p>\n<div class='midnight'><pre class=\"editor editor-colors\"><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>public</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--class syntax--identifier syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>class</span></span><span>&nbsp;</span><span class=\"syntax--entity syntax--name syntax--type syntax--class syntax--java\"><span>Singleton</span></span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--class syntax--begin syntax--java\"><span>{</span></span><span>&nbsp;&nbsp;</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--storage syntax--modifier syntax--java\"><span>private</span></span><span>&nbsp;</span><span class=\"syntax--storage syntax--modifier syntax--java\"><span>static</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--class syntax--identifier syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>class</span></span><span>&nbsp;</span><span class=\"syntax--entity syntax--name syntax--type syntax--class syntax--java\"><span>SingletonHolder</span></span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--class syntax--begin syntax--java\"><span>{</span></span><span>&nbsp;&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--storage syntax--modifier syntax--java\"><span>private</span></span><span>&nbsp;</span><span class=\"syntax--storage syntax--modifier syntax--java\"><span>static</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--definition syntax--variable syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>final</span></span><span>&nbsp;</span><span class=\"syntax--storage syntax--type syntax--java\"><span>Singleton</span></span><span>&nbsp;</span><span class=\"syntax--constant syntax--variable syntax--java\"><span>INSTANCE</span></span><span>&nbsp;</span><span class=\"syntax--keyword syntax--operator syntax--assignment syntax--java\"><span>=</span></span><span>&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--new syntax--java\"><span>new</span></span><span>&nbsp;</span><span class=\"syntax--storage syntax--type syntax--java\"><span>Singleton</span></span><span>(</span><span>)</span></span><span class=\"syntax--punctuation syntax--terminator syntax--java\"><span>;</span></span><span>&nbsp;&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--punctuation syntax--section syntax--class syntax--end syntax--java\"><span>}</span></span></span><span>&nbsp;&nbsp;</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>private</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--method syntax--identifier syntax--java\"><span class=\"syntax--entity syntax--name syntax--function syntax--java\"><span>Singleton</span></span><span>&nbsp;(</span><span>)</span></span><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--method syntax--begin syntax--java\"><span>{</span></span></span><span class=\"syntax--punctuation syntax--section syntax--method syntax--end syntax--java\"><span>}</span></span></span><span>&nbsp;&nbsp;</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>public</span></span><span>&nbsp;</span><span class=\"syntax--storage syntax--modifier syntax--java\"><span>static</span></span><span>&nbsp;</span><span class=\"syntax--storage syntax--modifier syntax--java\"><span>final</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--method syntax--return-type syntax--java\"><span class=\"syntax--storage syntax--type syntax--java\"><span>Singleton</span></span><span>&nbsp;</span></span><span class=\"syntax--meta syntax--method syntax--identifier syntax--java\"><span class=\"syntax--entity syntax--name syntax--function syntax--java\"><span>getInstance</span></span><span>(</span><span>)</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--method syntax--begin syntax--java\"><span>{</span></span><span>&nbsp;&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--keyword syntax--control syntax--java\"><span>return</span></span><span>&nbsp;</span><span class=\"syntax--storage syntax--type syntax--java\"><span>SingletonHolder</span></span><span class=\"syntax--constant syntax--other syntax--java\"><span class=\"syntax--keyword syntax--operator syntax--dereference syntax--java\"><span>.</span></span><span>INSTANCE</span></span><span class=\"syntax--punctuation syntax--terminator syntax--java\"><span>;</span></span><span>&nbsp;&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--punctuation syntax--section syntax--method syntax--end syntax--java\"><span>}</span></span></span><span>&nbsp;&nbsp;</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--class syntax--end syntax--java\"><span>}</span></span></span><span>&nbsp;&nbsp;&nbsp;</span></span></div></pre></div>\n<h3>6ã€æšä¸¾</h3>\n<p>JDK ç‰ˆæœ¬ï¼šJDK1.5 èµ·\næ˜¯å¦ Lazy åˆå§‹åŒ–ï¼šå¦\næ˜¯å¦å¤šçº¿ç¨‹å®‰å…¨ï¼šæ˜¯\nå®ç°éš¾åº¦ï¼šæ˜“\næè¿°ï¼šè¿™ç§å®ç°æ–¹å¼è¿˜æ²¡æœ‰è¢«å¹¿æ³›é‡‡ç”¨ï¼Œä½†è¿™æ˜¯å®ç°å•ä¾‹æ¨¡å¼çš„æœ€ä½³æ–¹æ³•ã€‚å®ƒæ›´ç®€æ´ï¼Œè‡ªåŠ¨æ”¯æŒåºåˆ—åŒ–æœºåˆ¶ï¼Œç»å¯¹é˜²æ­¢å¤šæ¬¡å®ä¾‹åŒ–ã€‚\nè¿™ç§æ–¹å¼æ˜¯ Effective Java ä½œè€… Josh Bloch æå€¡çš„æ–¹å¼ï¼Œå®ƒä¸ä»…èƒ½é¿å…å¤šçº¿ç¨‹åŒæ­¥é—®é¢˜ï¼Œè€Œä¸”è¿˜è‡ªåŠ¨æ”¯æŒåºåˆ—åŒ–æœºåˆ¶ï¼Œé˜²æ­¢ååºåˆ—åŒ–é‡æ–°åˆ›å»ºæ–°çš„å¯¹è±¡ï¼Œç»å¯¹é˜²æ­¢å¤šæ¬¡å®ä¾‹åŒ–ã€‚ä¸è¿‡ï¼Œç”±äº JDK1.5 ä¹‹åæ‰åŠ å…¥ enum ç‰¹æ€§ï¼Œç”¨è¿™ç§æ–¹å¼å†™ä¸å…è®©äººæ„Ÿè§‰ç”Ÿç–ï¼Œåœ¨å®é™…å·¥ä½œä¸­ï¼Œä¹Ÿå¾ˆå°‘ç”¨ã€‚\nä¸èƒ½é€šè¿‡ reflection attack æ¥è°ƒç”¨ç§æœ‰æ„é€ æ–¹æ³•ã€‚\nä»£ç å®ä¾‹ï¼š</p>\n<div class='midnight'><pre class=\"editor editor-colors\"><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>public</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--class syntax--identifier syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>enum</span></span><span>&nbsp;</span><span class=\"syntax--entity syntax--name syntax--type syntax--class syntax--java\"><span>Singleton</span></span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--class syntax--begin syntax--java\"><span>{</span></span><span>&nbsp;&nbsp;</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--constant syntax--other syntax--java\"><span>INSTANCE</span></span><span class=\"syntax--punctuation syntax--terminator syntax--java\"><span>;</span></span><span>&nbsp;&nbsp;</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--storage syntax--modifier syntax--java\"><span>public</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--method syntax--return-type syntax--java\"><span class=\"syntax--storage syntax--type syntax--primitive syntax--array syntax--java\"><span>void</span></span><span>&nbsp;</span></span><span class=\"syntax--meta syntax--method syntax--identifier syntax--java\"><span class=\"syntax--entity syntax--name syntax--function syntax--java\"><span>whateverMethod</span></span><span>(</span><span>)</span></span><span>&nbsp;</span><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--method syntax--begin syntax--java\"><span>{</span></span><span>&nbsp;&nbsp;</span></span></span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--meta syntax--class syntax--body syntax--java\"><span class=\"syntax--meta syntax--method syntax--java\"><span class=\"syntax--meta syntax--method syntax--body syntax--java\"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class=\"syntax--punctuation syntax--section syntax--method syntax--end syntax--java\"><span>}</span></span></span><span>&nbsp;&nbsp;</span></span></span></span></div><div class=\"line\"><span class=\"syntax--source syntax--java\"><span class=\"syntax--meta syntax--class syntax--java\"><span class=\"syntax--punctuation syntax--section syntax--class syntax--end syntax--java\"><span>}</span></span></span><span>&nbsp;&nbsp;</span></span></div></pre></div>\n<blockquote>\n<p>ç»éªŒä¹‹è°ˆï¼šä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸å»ºè®®ä½¿ç”¨ç¬¬ 1 ç§å’Œç¬¬ 2 ç§æ‡’æ±‰æ–¹å¼ï¼Œå»ºè®®ä½¿ç”¨ç¬¬ 3 ç§é¥¿æ±‰æ–¹å¼ã€‚åªæœ‰åœ¨è¦æ˜ç¡®å®ç° lazy loading æ•ˆæœæ—¶ï¼Œæ‰ä¼šä½¿ç”¨ç¬¬ 5 ç§ç™»è®°æ–¹å¼ã€‚å¦‚æœæ¶‰åŠåˆ°ååºåˆ—åŒ–åˆ›å»ºå¯¹è±¡æ—¶ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨ç¬¬ 6 ç§æšä¸¾æ–¹å¼ã€‚å¦‚æœæœ‰å…¶ä»–ç‰¹æ®Šçš„éœ€æ±‚ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ç¬¬ 4 ç§åŒæ£€é”æ–¹å¼ã€‚</p>\n</blockquote>","frontmatter":{"title":"å•ä¾‹æ¨¡å¼","date":"2017-10-10"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/singleton-pattern/","previous":{"fields":{"slug":"/strategy-pattern/"},"frontmatter":{"title":"ç­–ç•¥æ¨¡å¼"}},"next":{"fields":{"slug":"/mac-osx-ruby-upgrade/"},"frontmatter":{"title":"mac osx ruby å‡çº§"}}}}